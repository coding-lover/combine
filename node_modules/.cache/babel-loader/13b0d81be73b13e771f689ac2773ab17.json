{"remainingRequest":"/Users/zou/data/www/combine/node_modules/babel-loader/lib/index.js!/Users/zou/data/www/combine/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zou/data/www/combine/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zou/data/www/combine/src/components/common/AccountsTestUnit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zou/data/www/combine/src/components/common/AccountsTestUnit.vue","mtime":1618905572000},{"path":"/Users/zou/data/www/combine/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zou/data/www/combine/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zou/data/www/combine/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zou/data/www/combine/node_modules/vue-loader/lib/index.js","mtime":1655715099000},{"path":"/Users/zou/data/www/combine/babel.config.js","mtime":1698336527619},{"path":"/Users/zou/data/www/combine/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zou/data/www/combine/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zou/data/www/combine/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zou/data/www/combine/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":["import _toConsumableArray from \"/Users/zou/data/www/combine/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray.js\";\nimport MyPrism from \"./MyPrism\";\nexport default {\n  props: {\n    title: {\n      type: String,\n      default: ''\n    },\n    func: {\n      type: String,\n      default: ''\n    },\n    rules: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    options: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    }\n  },\n  data: function data() {\n    var _this = this;\n    return {\n      num: 0,\n      plugins: ['line-numbers'],\n      targetFunc: null,\n      result: {},\n      //form-create\n      fApi: {},\n      fOptions: {},\n      fRules: [],\n      defaultRules: [{\n        type: 'el-button',\n        field: 'submitBtn',\n        on: {\n          click: function click() {\n            //TODO 提交表单\n            _this.onSubmit(_this.fApi);\n          }\n        },\n        props: {\n          type: 'primary'\n        },\n        col: {\n          //span:3,\n          //spush: 1\n        },\n        children: ['提交']\n      }],\n      defaultOptions: {\n        form: {\n          //行内表单模式\n          inline: true,\n          labelWidth: 'auto'\n        },\n        row: {\n          //justify: 'start',\n        },\n        submitBtn: false\n      }\n    };\n  },\n  components: {\n    MyPrism: MyPrism\n  },\n  computed: {\n    curFunc: function curFunc() {}\n  },\n  created: function created() {\n    var _this$fRules, _this$fRules2;\n    //console.log('unit create ................');\n    (_this$fRules = this.fRules).push.apply(_this$fRules, _toConsumableArray(this.rules));\n    (_this$fRules2 = this.fRules).push.apply(_this$fRules2, _toConsumableArray(this.defaultRules));\n    this.fOptions = Object.assign(this.options, this.defaultOptions);\n  },\n  mounted: function mounted() {},\n  methods: {\n    enableSubmit: function enableSubmit() {\n      var flag = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      this.fApi.disabled(!flag, 'submitBtn');\n    },\n    onSubmit: function onSubmit(fApi) {\n      var _this2 = this;\n      fApi.validate(function (valid) {\n        if (!valid) {\n          return false;\n        }\n        var func = _this2.func;\n        if (fApi.form.func) {\n          func = fApi.form.func;\n        }\n        if (!_this2.checkFunc(func)) {\n          return false;\n        }\n        console.log(_this2.targetFunc);\n        _this2.enableSubmit(false);\n        _this2.targetFunc(fApi.form).then(function (res) {\n          console.log(res);\n          if (res.code && res.code != 200) {\n            _this2.$notify({\n              title: '错误',\n              message: \"#\".concat(_this2.$props.func, \"\\u83B7\\u53D6\\u5931\\u8D25 <br /> \").concat(res.msg),\n              type: 'error'\n            });\n            _this2.result = res.payload;\n            return false;\n          }\n          _this2.result = res.payload;\n          _this2.$notify({\n            title: '成功',\n            message: \"#\".concat(_this2.$props.func, \"  \\u83B7\\u53D6\\u6210\\u529F\"),\n            type: 'success'\n          });\n        }).finally(function () {\n          _this2.enableSubmit(true);\n        });\n      });\n    },\n    checkFunc: function checkFunc(func) {\n      var tmp = require(\"../../api/accounts\");\n      if (!tmp || !tmp[func]) {\n        this.targetFunc = null;\n        this.$notify.error({\n          title: '错误',\n          message: func + ' 方法找不到！'\n        });\n        return false;\n      }\n      this.targetFunc = tmp[func];\n      return true;\n    }\n  }\n};",{"version":3,"mappings":";AA4BA;AACA;EACAA;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;MACAC;IACA;IACAE;MACAH;MACAC;QACA;MACA;IACA;IACAG;MACAJ;MACAC;QACA;MACA;IACA;EACA;EACAI;IAAA;IACA;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC,eACA;QACAb;QACAc;QACAC;UACAC;YACA;YACA;UACA;QACA;QACAlB;UACAE;QACA;QACAiB;UACA;UACA;QACA;QACAC;MAEA,EACA;MACAC;QACAC;UACA;UACAC;UACAC;QACA;QACAC;UACA;QACA;QACAC;MACA;IACA;EACA;EACAC;IACAC;EACA;EACAC;IACAC,6BAEA;EACA;EACAC;IAAA;IACA;IACA;IACA;IACA;EACA;EACAC,6BAGA;EACAC;IACAC;MAAA;MACA;IACA;IACAC;MAAA;MACAvB;QACA;UACA;QACA;QAEA;QACA,oBACA;UACAR;QACA;QAEA,6BACA;UACA;QACA;QAEAgC;QAEA;QACA;UACAA;UACA;YACA;cACAnC;cACAoC;cACAnC;YACA;YACA;YACA;UACA;UAEA;UACA;YACAD;YACAoC;YACAnC;UACA;QACA;UACA;QACA;MACA;IACA;IAEAoC;MACA;MACA,wBACA;QACA;QACA;UAAArC;UAAAoC;QAAA;QACA;MACA;MAEA;MACA;IACA;EACA;AACA","names":["props","title","type","default","func","rules","options","data","num","plugins","targetFunc","result","fApi","fOptions","fRules","defaultRules","field","on","click","col","children","defaultOptions","form","inline","labelWidth","row","submitBtn","components","MyPrism","computed","curFunc","created","mounted","methods","enableSubmit","onSubmit","console","message","checkFunc"],"sourceRoot":"src/components/common","sources":["AccountsTestUnit.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n                <span><span class=\"font-bold\">{{title}}</span> {{func}}</span>\r\n            </div>\r\n\r\n            <form-create v-model=\"fApi\" :rule=\"fRules\" :option=\"fOptions\" class=\"mt-10\"></form-create>\r\n            <el-collapse value=\"1\">\r\n                <el-collapse-item>\r\n                    <template slot=\"title\">\r\n                        代码\r\n                    </template>\r\n                    <my-prism  :plugins=\"plugins\" style=\"height: 300px;overflow-y: auto\"><slot name=\"u-code\"></slot></my-prism>\r\n                </el-collapse-item>\r\n                <el-collapse-item name=\"1\">\r\n                    <template slot=\"title\" >\r\n                        结果 <!--<i class=\"header-icon el-icon-lock\"></i>-->\r\n                    </template>\r\n                    <json-viewer :value=\"result\" :expand-depth=\"5\" style=\"\" copyable></json-viewer>\r\n                </el-collapse-item>\r\n            </el-collapse>\r\n        </el-card>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\n    import MyPrism from \"./MyPrism\";\r\n    export default {\r\n        props: {\r\n            title: {\r\n                type: String,\r\n                default: '',\r\n            },\r\n            func: {\r\n                type: String,\r\n                default: '',\r\n            },\r\n            rules: {\r\n                type: Array,\r\n                default: function() {\r\n                    return [];\r\n                },\r\n            },\r\n            options: {\r\n                type: Object,\r\n                default: function() {\r\n                    return {};\r\n                },\r\n            },\r\n        },\r\n        data () {\r\n            return {\r\n                num: 0,\r\n                plugins: ['line-numbers'],\r\n                targetFunc: null,\r\n                result: {},\r\n\r\n                //form-create\r\n                fApi: {},\r\n                fOptions: {},\r\n                fRules: [],\r\n                defaultRules: [\r\n                    {\r\n                        type: 'el-button',\r\n                        field: 'submitBtn',\r\n                        on: {\r\n                            click: () => {\r\n                                //TODO 提交表单\r\n                                this.onSubmit(this.fApi);\r\n                            }\r\n                        },\r\n                        props: {\r\n                            type: 'primary',\r\n                        },\r\n                        col: {\r\n                            //span:3,\r\n                            //spush: 1\r\n                        },\r\n                        children: ['提交']\r\n\r\n                    }\r\n                ],\r\n                defaultOptions: {\r\n                    form: {\r\n                        //行内表单模式\r\n                        inline: true,\r\n                        labelWidth: 'auto',\r\n                    },\r\n                    row: {\r\n                        //justify: 'start',\r\n                    },\r\n                    submitBtn: false,\r\n                },\r\n            }\r\n        },\r\n        components: {\r\n            MyPrism\r\n        },\r\n        computed: {\r\n            curFunc() {\r\n\r\n            },\r\n        },\r\n        created() {\r\n            //console.log('unit create ................');\r\n            this.fRules.push(...this.rules);\r\n            this.fRules.push(...this.defaultRules);\r\n            this.fOptions = Object.assign(this.options, this.defaultOptions);\r\n        },\r\n        mounted() {\r\n\r\n\r\n        },\r\n        methods: {\r\n            enableSubmit(flag = true) {\r\n                this.fApi.disabled(!flag, 'submitBtn');\r\n            },\r\n            onSubmit(fApi) {\r\n                fApi.validate((valid) => {\r\n                    if(!valid) {\r\n                        return false;\r\n                    }\r\n\r\n                    let func = this.func;\r\n                    if(fApi.form.func)\r\n                    {\r\n                        func = fApi.form.func;\r\n                    }\r\n\r\n                    if(!this.checkFunc(func))\r\n                    {\r\n                        return false;\r\n                    }\r\n\r\n                    console.log(this.targetFunc);\r\n\r\n                    this.enableSubmit(false);\r\n                    this.targetFunc(fApi.form).then(res => {\r\n                        console.log(res);\r\n                        if(res.code && res.code != 200) {\r\n                            this.$notify({\r\n                                title: '错误',\r\n                                message: `#${this.$props.func}获取失败 <br /> ${res.msg}`,\r\n                                type: 'error'\r\n                            });\r\n                            this.result = res.payload;\r\n                            return false;\r\n                        }\r\n\r\n                        this.result = res.payload;\r\n                        this.$notify({\r\n                            title: '成功',\r\n                            message: `#${this.$props.func}  获取成功`,\r\n                            type: 'success'\r\n                        });\r\n                    }).finally(() => {\r\n                        this.enableSubmit(true);\r\n                    });\r\n                });\r\n            },\r\n\r\n            checkFunc(func) {\r\n                let tmp = require('../../api/accounts');\r\n                if(!tmp || !tmp[func])\r\n                {\r\n                    this.targetFunc = null;\r\n                    this.$notify.error({title: '错误', message: func + ' 方法找不到！'});\r\n                    return false;\r\n                }\r\n\r\n                this.targetFunc = tmp[func];\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    h1{\r\n        text-align: center;\r\n        margin: 30px 0;\r\n    }\r\n    p{\r\n        line-height: 30px;\r\n        margin-bottom: 10px;\r\n        text-indent: 2em;\r\n    }\r\n    .logout{\r\n        color: #409EFF;\r\n    }\r\n    .mt-5 {\r\n        margin-top: 5px;\r\n    }\r\n    .mt-10 {\r\n        margin-top: 5px;\r\n    }\r\n    .font-bold {\r\n        font-weight: bold;\r\n    }\r\n\r\n</style>\r\n"]}]}