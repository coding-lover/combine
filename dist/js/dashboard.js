(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dashboard"],{"14b96":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{attrs:{gutter:10}},[a("el-col",{staticClass:"wrap",attrs:{span:18,offset:3}},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"wrap-padding",attrs:{name:"first"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("文件替换"),a("el-badge",{staticClass:"large-btn",attrs:{value:e.totalNum,hidden:!(e.totalNum>0)}})],1),e._l(e.nodeList,(function(t,i){return a("el-col",{staticClass:"margin-bottom-10",attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"要替换字符"},model:{value:t.search,callback:function(a){e.$set(t,"search",a)},expression:"item.search"}})],1),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{"prefix-icon":"el-icon-edit",placeholder:"替换后字符"},model:{value:t.replace,callback:function(a){e.$set(t,"replace",a)},expression:"item.replace"}})],1),a("el-badge",{attrs:{value:t.fileNum,hidden:!(t.fileNum>0)}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.replaceFlag(i),expression:"!replaceFlag(idx)"}],staticClass:"ml-3",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.doReplace(i)}}},[e._v("替换\n                                ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.replaceFlag(i),expression:"replaceFlag(idx)"}],staticClass:"ml-3",attrs:{size:"small",type:"success"}},[e._v("已替换")]),a("el-button",{staticClass:"ml-3",attrs:{size:"small",type:"success"},on:{click:function(t){return e.getReplaceHis(i)}}},[e._v("替换历史")])],1),a("el-button",{staticClass:"margin-left-3",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.downloadFile(i)}}},[e._v("下载")])],1),a("div",{staticClass:"content-overflow"},[a("el-upload",{ref:e.createUploadKey(i),refInFor:!0,staticClass:"upload-demo",attrs:{drag:"",action:"","on-preview":e.handlePreview,"on-remove":e.handleRemove(i),"on-progress":e.handleProgress,"on-change":e.myHandleChange(i),"file-list":e.fileList,"auto-upload":!1,multiple:""}},[a("i",{directives:[{name:"show",rawName:"v-show",value:0==t.fileNum,expression:"item.fileNum == 0"}],staticClass:"el-icon-upload"}),a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.fileNum,expression:"item.fileNum == 0"}],staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])])],1)])],1)})),a("el-col",{staticClass:"margin-bottom-10",attrs:{span:12}},[a("div",{staticClass:"my-avatar-uploader content-overflow",on:{click:e.addNode}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("el-row",{staticClass:"mt-10"},[a("el-badge",{staticClass:"large-btn",attrs:{value:e.totalNum,hidden:!(e.totalNum>0)}},[a("el-button",{staticClass:"large-btn",attrs:{type:"danger",size:"medium"},on:{click:e.batchReplace}},[e._v("批量替换")])],1)],1),a("el-row",{staticClass:"mt-10"},[a("el-button",{staticClass:"large-btn",attrs:{type:"primary",size:"medium"},on:{click:e.batchDownload}},[e._v("批量下载")])],1)],1)],2),a("el-tab-pane",{attrs:{label:"文件合并",name:"second"}},[a("el-col",{attrs:{span:10}},[a("el-form",{ref:"form",attrs:{rules:e.formRules,model:e.form,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"使用替换"}},[a("el-switch",{model:{value:e.form.delivery,callback:function(t){e.$set(e.form,"delivery",t)},expression:"form.delivery"}}),a("span",{staticStyle:{color:"#F56C6C","margin-left":"5px",display:"inline-block"}},[e._v("使用已经替换的文件或者重新上传文件")])],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.form.delivery,expression:"!form.delivery"}],attrs:{label:"上传"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("上传"),a("el-badge",{attrs:{value:e.specialNum,hidden:!(e.specialNum>0)}})],1),a("el-upload",{ref:e.createUploadKey(e.specialKey),attrs:{drag:"",action:"","on-change":e.myHandleChange(e.specialKey),"on-remove":e.handleRemove(e.specialKey),"auto-upload":!1,multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[a("p",[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])])])],1),a("el-form-item",{attrs:{label:"文件头",prop:"fileHeader"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.fileHeader,callback:function(t){e.$set(e.form,"fileHeader",t)},expression:"form.fileHeader"}})],1),a("el-form-item",{attrs:{label:"文件尾",prop:"fileFooter"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.fileFooter,callback:function(t){e.$set(e.form,"fileFooter",t)},expression:"form.fileFooter"}})],1),a("el-form-item",{attrs:{label:"文件名",prop:"fileName"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}},[a("el-select",{attrs:{slot:"append",placeholder:"请选择",prop:"fileSuffix"},slot:"append",model:{value:e.form.fileSuffix,callback:function(t){e.$set(e.form,"fileSuffix",t)},expression:"form.fileSuffix"}},e._l(e.form.fileSuffixOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1),a("el-form-item",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.form.ready,expression:"form.ready"}],attrs:{type:"primary"},on:{click:e.combineFile}},[e._v("立即合并")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.form.ready,expression:"!form.ready"}],attrs:{type:"primary",loading:!0}},[e._v("合并中")]),a("el-button",{on:{click:function(t){return e.formReset()}}},[e._v("取消")])],1)],1)],1),a("el-col",{attrs:{span:14}},[a("div",{staticClass:"drag-box"},[a("div",{staticClass:"drag-box-item"},[a("el-empty",{directives:[{name:"show",rawName:"v-show",value:0==e.getFileList.length,expression:"getFileList.length == 0"}],attrs:{description:"未上传文件"}}),a("el-table-draggable",{attrs:{handle:".allowDrag"},on:{drop:e.dragChange}},[a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.getFileList.length>0,expression:"getFileList.length > 0"}],ref:"dragTable",staticStyle:{width:"100%"},attrs:{data:e.getFileList}},[a("el-table-column",{attrs:{prop:"id",label:"拖拽",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("i",{staticClass:"el-icon-rank allowDrag",staticStyle:{cursor:"pointer"}}),e._v(" "+e._s(i.id)+"\n                                        ")]}}])}),a("el-table-column",{attrs:{prop:"name",label:"文件名",width:"230"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"overflow-text"},[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{prop:"option",label:"操作"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.dragConfig.optionVal,callback:function(t){e.$set(e.dragConfig,"optionVal",t)},expression:"dragConfig.optionVal"}},e._l(e.dragConfig.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-input-number",{staticClass:" ml-3",attrs:{size:"mini","controls-position":"right",min:0,max:10,placeholder:"值"},model:{value:e.dragConfig.setVal,callback:function(t){e.$set(e.dragConfig,"setVal",t)},expression:"dragConfig.setVal"}}),a("el-button",{staticClass:"ml-3",attrs:{type:"primary",size:"mini"},on:{click:e.fileConfigAdd}},[e._v("加")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.fileConfigReduce}},[e._v("减")])]}},{key:"default",fn:function(t){return[a("el-input-number",{ref:e.createDeleteKey(t.row.id,"headerDeleteLine"),attrs:{controls:!1,size:"mini","controls-position":"right",min:0,placeholder:"文件头删除行数"},model:{value:t.row.headerDeleteLine,callback:function(a){e.$set(t.row,"headerDeleteLine",a)},expression:"scope.row.headerDeleteLine"}}),a("el-input-number",{ref:e.createDeleteKey(t.row.id,"footerDeleteLine"),staticClass:"ml-3",attrs:{controls:!1,size:"mini","controls-position":"right",min:0,placeholder:"文件尾删除行数"},model:{value:t.row.footerDeleteLine,callback:function(a){e.$set(t.row,"footerDeleteLine",a)},expression:"scope.row.footerDeleteLine"}})]}}])})],1)],1)],1)])])],1)],1)],1)],1)},s=[],n=(a("9865"),a("7f7f"),a("ac6aa"),a("5df3"),a("28a5"),a("d25f"),a("75fc")),r=(a("6d67"),a("57e7"),a("a481"),a("386d"),a("8914")),o={data:function(){var e=this;return{activeName:"first",fileList:[],tmpFileNames:[],nodeList:[],nodeNum:2,replaceHis:[],specialFileList:[],specialKey:99,form:{fileHeader:"",fileFooter:"",fileName:"",fileSuffix:".nc",fileSuffixOptions:[{value:".nc",name:".nc"},{value:".pim",name:".pim"}],ready:!0,delivery:!0},dragOptions:{animation:120,scroll:!0,group:"sortlist",ghostClass:"ghost-style"},curId:0,combineFileList:[],dragList:[],dragConfig:{optionVal:0,options:[{value:0,label:"文件头删除行数"},{value:1,label:"文件尾删除行数"}],setVal:1},formRules:{fileHeader:[{required:!0,message:"请输入文件头",trigger:"blur"}],fileFooter:[{required:!0,message:"请输入文件尾",trigger:"change"}],fileName:[{required:!0,message:"请输入完整文件名",trigger:"change",validator:function(t,a,i){return e.form.fileName?""===e.form.fileSuffix?i(new Error("请选择文件后缀")):void i():i(new Error("请输入完整文件名"))}}],fileSuffix:[{required:!0,message:"请选择文件后缀",trigger:"change"}]}}},components:{ElTableDraggable:r["a"]},computed:{replaceFlag:function(){var e=this;return function(t){if(!e.nodeList.hasOwnProperty(t))return!1;var a=e.nodeList[t],i=e.createReplaceKey(a.search,a.replace);return-1!=a.replaceHis.indexOf(i)}},totalNum:function(){var e=0;return this.nodeList.map((function(t){e+=t.fileList.length})),e},specialNum:function(){return this.specialFileList.length},getFileList:{get:function(){var e=[];return this.form.delivery?this.nodeList.map((function(t,a){t.fileList.map((function(t,i){t.nodeIdx=a,t.fileIdx=i,e.push(t)}))})):e.push.apply(e,Object(n["a"])(this.specialFileList)),e},set:function(e){console.warn(e)}},getFileBadge:function(){var e=this;return function(t){return t+(e.totalNum>0?'<el-badge value="'+e.totalNum+'" class="large-btn"  />':"")}}},watch:{},mounted:function(){this.initNodeList()},methods:{combineFile:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;var a=[],i=[];if(e.nodeList.map((function(e){e.fileList.map((function(e){i.push(e.id),a.push(e)}))})),a.push.apply(a,Object(n["a"])(e.specialFileList)),e.dragList.length!=a.length&&(e.dragList=a),0==e.dragList.length)return e.$message.info("请上传要合并的文件"),!1;var s=[];if(e.dragList.map((function(t){if(e.form.delivery&&-1==i.indexOf(t.id))return!1;if(!e.form.delivery&&-1!=i.indexOf(t.id))return!1;var a=e.readFile(t,(function(e){return e=e.split("\n").filter((function(e){return e})),e.splice(0,t.headerDeleteLine),e.splice(e.length-t.footerDeleteLine,t.footerDeleteLine),e.join("\n")}));s.push(a)})),0==s.length)return e.$message.info("请上传文件"),!1;e.form.ready=!1,Promise.all([].concat(s)).then((function(t){console.log(t),t.unshift(e.form.fileHeader),t.push(e.form.fileFooter),t=t.filter((function(e){return e})),t=t.join("\n"),console.log(t),e.form.ready=!0,e.downloadFileByContent(t,e.form.fileName+e.form.fileSuffix)})),console.log("content")}))},test:function(e){return new Promise((function(t,a){var i=Math.ceil(1e4*Math.random());console.warn("执行 "+e),setTimeout((function(){t(i+"-"+e)}),i)}))},readFile:function(e,t){return new Promise((function(a,i){var s=new FileReader;s.onloadend=function(e){a(t(e.target.result))},s.readAsText(e.raw)}))},fileConfigAdd:function(){this.dispatchFileConfig(!0)},fileConfigReduce:function(){this.dispatchFileConfig(!1)},dispatchFileConfig:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.form.delivery?this.nodeList.map((function(a){a.fileList.map((function(a){e.doUpdateDeletedLine(a,t)}))})):this.specialFileList.map((function(a){e.doUpdateDeletedLine(a,t)}))},doUpdateDeletedLine:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=0==this.dragConfig.optionVal?"headerDeleteLine":"footerDeleteLine";e[a]=void 0==e[a]?0:e[a],t?e[a]+=this.dragConfig.setVal:e[a]-=this.dragConfig.setVal,e[a]=e[a]<0?0:e[a],this.updateDeletedLine(e.id,a,e[a])},updateDeletedLine:function(e,t,a){var i=this.createDeleteKey(e,t);this.$refs[i].setCurrentValue(a)},dragChange:function(e){this.dragList=e.list,console.log(e)},formReset:function(){for(var e in this.$refs.form.resetFields(),this.form)"fileSuffixOptions"!=e&&this.form.hasOwnProperty(e)&&(this.form[e]="ready"==e||"delivery"==e||"")},removeHandle:function(e){console.log(e),this.$message.success("从 ".concat(e.from.id," 移动到 ").concat(e.to.id," "))},addNode:function(){this.nodeList.push(this.initNode())},batchReplace:function(){var e=this;this.nodeList.map((function(t,a){e.doReplace(a)}))},batchDownload:function(){var e=this;this.nodeList.map((function(t,a){e.downloadFile(a)}))},getReplaceHis:function(e){if(0==this.nodeList[e].replaceHis.length)return this.$message.info("没有替换历史"),!1;var t="";this.nodeList[e].replaceHis.map((function(e,a){t+="<p>#".concat(a," ").concat(e,"<p>")})),this.$alert(t,"替换历史",{dangerouslyUseHTMLString:!0})},doReplace:function(e){var t=this;if(0==this.nodeList[e].fileList.length)return this.$message.info("请先上传文件！"),!1;var a=this.nodeList[e],i=this.createReplaceKey(a.search,a.replace);a.replaceHis.push(i),a.fileList.map((function(e){var i=new FileReader;i.onload=function(i){var s=i.target.result.replaceAll(a.search,a.replace);console.info("replace: "+s),e.raw=new File([s],e.name,{name:e.name,size:s.length,type:e.type,lastModified:e.lastModified}),t.$message({message:e.name+" 替换成功",type:"success"})},i.readAsText(e.raw)})),this.$message({message:e+"-"+i,type:"success"})},downloadFileByContent:function(e,t){var a=new File([e],t);this.downloadBlob(URL.createObjectURL(a),t)},downloadFile:function(e){var t=this;if(!this.nodeList.hasOwnProperty(e))return this.$message.info("请上传文件！"),!1;this.nodeList[e].fileList.map((function(a){var i=URL.createObjectURL(a.raw),s=a.name.substring(0,a.name.lastIndexOf(".")),n=a.name.substring(a.name.lastIndexOf("."));t.nodeList[e].replaceHis.length>0&&(s+="("+t.nodeList[e].replaceHis.join(",")+")"),console.warn(a.name),t.downloadBlob(i,s+n)}))},initNodeList:function(){for(var e=0;e<this.nodeNum;e++)this.nodeList.push(this.initNode())},initNode:function(){return{search:"",replace:"",fileNum:0,fileList:[],isReplace:!1,replaceHis:[]}},handleClick:function(e,t){console.log(e,t)},handleRemove:function(e){var t=this;return function(a,i){for(var s in console.log(a,i),i)if(a.name==i[s].name)return!1;e==t.specialKey?t.specialFileList=i:(t.nodeList[e].fileNum--,t.nodeList[e].fileList=i,0==i.length&&(t.nodeList[e].replaceHis=[]));var n=t.tmpFileNames[e].indexOf(a.name);delete t.tmpFileNames[e][n]}},handlePreview:function(e){console.log(e)},handleProgress:function(e,t,a){console.log(e,t)},myHandleChange:function(e){var t=this;return function(a,i){if(t.tmpFileNames.hasOwnProperty(e)||(t.tmpFileNames[e]=[]),-1!=t.tmpFileNames[e].indexOf(a.name))return t.$message.warning("出现重复文件： "+a.name+", 取消当前上传！"),console.log(t.createUploadKey(e)),console.log(t.$refs[t.createUploadKey(e)]),e==t.specialKey?t.$refs[t.createUploadKey(e)].handleRemove(a,a.raw):t.$refs[t.createUploadKey(e)][0].handleRemove(a,a.raw),!1;a.id=t.createId(),a.headerDeleteLine=1,a.footerDeleteLine=1,e==t.specialKey?(t.specialFileList=i,console.log(t.specialFileList)):(t.nodeList[e].fileNum++,t.nodeList[e].fileList=i),t.tmpFileNames[e].push(a.name)}},downloadBlob:function(e,t,a){var i=document.createElement("a");i.href=e,i.download=t,console.log(t),document.body.appendChild(i),i.click(),document.body.removeChild(i),(null==a||a)&&window.URL.revokeObjectURL(e)},createUploadKey:function(e){return"upload"+e},createReplaceKey:function(e,t){return e+" = "+t},createId:function(){return this.curId++},createDeleteKey:function(e,t){return e+"-"+t}}},l=o,c=(a("1f7f"),a("2877")),d=Object(c["a"])(l,i,s,!1,null,null,null);t["default"]=d.exports},"1f7f":function(e,t,a){"use strict";a("fb4e")},"2c8a":function(e,t,a){!function(t,a){e.exports=a()}(0,(function(){"use strict";function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var a=window.devicePixelRatio||1,i=10*a,s=i/2;return function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.canvas=function(e){var t=document.getElementById(e),i=t.parentNode.clientWidth,s=t.parentNode.clientHeight;return t.style.width=i+"px",t.style.height=s+"px",t.width=i*a,t.height=s*a,t}(e),this.ctx=this.canvas.getContext("2d"),this.type="bar",this.showValue=!0,this.showGrid=!0,this.topPadding=60*a,this.leftPadding=50*a,this.rightPadding=10*a,this.bottomPadding=50*a,this.yEqual=5,this.yLength=0,this.xLength=0,this.ySpace=0,this.xRorate=0,this.yRorate=0,this.xRotate=0,this.yRotate=0,this.bgColor="#fff",this.axisColor="#666",this.gridColor="#eee",this.title={text:"",color:"#666",position:"top",font:"bold "+18*a+"px Arial",top:i,bottom:s},this.legend={display:!0,position:"top",color:"#666",font:14*a+"px Arial",top:45*a,bottom:15*a,textWidth:0},this.radius=100*a,this.innerRadius=60*a,this.colorList=["#4A90E2","#F5A623","#ff5858","#5e64ff","#2AC766","#743ee2","#b554ff","#199475"],this.init(t)}return function(t,a,i){a&&e(t.prototype,a),i&&e(t,i)}(n,[{key:"init",value:function(e){if(e.title=Object.assign({},this.title,e.title),e.legend=Object.assign({},this.legend,e.legend),Object.assign(this,e),!e.labels||!e.labels.length)throw new Error("缺少主要参数labels");if(!e.datasets||!e.datasets.length)throw new Error("缺少主要参数datasets");this.drawBackground(),"bar"===this.type||"line"===this.type?this.renderBarChart():this.renderPieChart(),this.drawLegend()}},{key:"renderBarChart",value:function(){this.yLength=Math.floor((this.canvas.height-this.topPadding-this.bottomPadding-i)/this.yEqual),this.xLength=Math.floor((this.canvas.width-this.leftPadding-this.rightPadding-i)/this.labels.length),this.ySpace=function(e,a){var i=e.map((function(e){return e.data.reduce((function(e,t){return t<e?e:t}))})),s=Math.ceil(Math.max.apply(Math,t(i))/a),n=s.toString().length-1;return n=2<n?2:n,Math.ceil(s/Math.pow(10,n))*Math.pow(10,n)}(this.datasets,this.yEqual),this.drawXAxis(),this.drawYAxis(),this.drawBarContent()}},{key:"drawBarContent",value:function(){var e=this.ctx,t=this.datasets.length;e.beginPath();for(var n=0;n<t;n++){e.font=this.legend.font,this.legend.textWidth+=Math.ceil(e.measureText(this.datasets[n].label).width),e.fillStyle=e.strokeStyle=this.datasets[n].fillColor||this.colorList[n];for(var r=this.datasets[n].data,o=0;o<r.length;o++)if(!(o>this.labels.length-1)){var l=this.xLength/(t+1),c=this.yLength/this.ySpace,d=this.leftPadding+this.xLength*o+l*(n+.5),h=d+l,u=this.canvas.height-this.bottomPadding,f=u-r[o]*c;if("bar"===this.type)e.fillRect(d,f,h-d,u-f),this.drawValue(r[o],d+l/2,f-s);else if("line"===this.type){var p=this.leftPadding+this.xLength*(o+.5);e.beginPath(),e.arc(p,f,3*a,0,2*Math.PI,!0),e.fill(),0!==o&&(e.beginPath(),e.strokeStyle=this.datasets[n].fillColor||this.colorList[n],e.lineWidth=2*a,e.moveTo(p-this.xLength,u-r[o-1]*c),e.lineTo(p,f),e.stroke(),e.lineWidth=1*a),this.drawValue(r[o],p,f-i)}}}e.stroke()}},{key:"renderPieChart",value:function(){for(var e=this.ctx,t=this.labels.length,a=this.datasets[0],i=a.data,s=i.reduce((function(e,t){return e+t})),n=-Math.PI/2,r=this.canvas.width/2,o=this.canvas.height/2,l=0;l<t;l++){e.font=this.legend.font,this.legend.textWidth+=Math.ceil(e.measureText(this.labels[l]).width),e.beginPath(),e.strokeStyle=e.fillStyle=a.colorList&&a.colorList[l]||this.colorList[l],e.moveTo(r,o);var c=n,d=n+=i[l]/s*2*Math.PI;e.arc(r,o,this.radius,c,d),e.closePath(),e.fill();var h=(c+d)/2;this.drawPieValue(i[l],h)}"ring"===this.type&&(e.beginPath(),e.fillStyle=this.bgColor,e.arc(r,o,this.innerRadius,0,2*Math.PI),e.closePath(),e.fill())}},{key:"drawValue",value:function(e,t,i){var s=this.ctx;this.showValue&&(s.textBaseline="middle",s.font=12*a+"px Arial",s.textAlign="center",s.fillText(e,t,i))}},{key:"drawPieValue",value:function(e,t){var a=this.ctx;if(this.showValue){var s=this.canvas.width/2,n=this.canvas.height/2,r=Math.ceil(Math.abs(this.radius*Math.cos(t))),o=Math.floor(Math.abs(this.radius*Math.sin(t)));a.textBaseline="middle",this.showValue&&(t<=0?(a.textAlign="left",a.moveTo(s+r,n-o),a.lineTo(s+r+i,n-o-i),a.moveTo(s+r+i,n-o-i),a.lineTo(s+r+3*i,n-o-i),a.stroke(),a.fillText(e,s+r+3.5*i,n-o-i)):0<t&&t<=Math.PI/2?(a.textAlign="left",a.moveTo(s+r,n+o),a.lineTo(s+r+i,n+o+i),a.moveTo(s+r+i,n+o+i),a.lineTo(s+r+3*i,n+o+i),a.stroke(),a.fillText(e,s+r+3.5*i,n+o+i)):t>Math.PI/2&&t<Math.PI?(a.textAlign="right",a.moveTo(s-r,n+o),a.lineTo(s-r-i,n+o+i),a.moveTo(s-r-i,n+o+i),a.lineTo(s-r-3*i,n+o+i),a.stroke(),a.fillText(e,s-r-3.5*i,n+o+i)):(a.textAlign="right",a.moveTo(s-r,n-o),a.lineTo(s-r-i,n-o-i),a.moveTo(s-r-i,n-o-i),a.lineTo(s-r-3*i,n-o-i),a.stroke(),a.fillText(e,s-r-3.5*i,n-o-i)))}}},{key:"drawBackground",value:function(){this.ctx.fillStyle=this.bgColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.drawTitle()}},{key:"drawTitle",value:function(){var e=this.title;if(e.text){var t=this.ctx;t.beginPath(),t.font=e.font,t.textAlign="center",t.fillStyle=e.color,"top"===e.position?(t.textBaseline="top",t.fillText(e.text,this.canvas.width/2,e.top)):(t.textBaseline="bottom",t.fillText(e.text,this.canvas.width/2,this.canvas.height-e.bottom))}}},{key:"drawXAxis",value:function(){var e=this.ctx,t=this.canvas.height-this.bottomPadding+.5;e.beginPath(),e.strokeStyle=this.axisColor,e.moveTo(this.leftPadding,t),e.lineTo(this.canvas.width-this.rightPadding,t),e.stroke(),this.drawXPoint()}},{key:"drawXPoint",value:function(){var e=this.ctx;e.beginPath(),e.font=12*a+"px Microsoft YaHei",e.textAlign=this.xRorate||this.xRotate?"right":"center",e.textBaseline="top",e.fillStyle=this.axisColor;for(var t=0;t<this.labels.length;t++){var n=this.labels[t],r=this.leftPadding+this.xLength*(t+1)+.5,o=this.canvas.height-this.bottomPadding;this.showGrid?(e.strokeStyle=this.gridColor,e.moveTo(r,o),e.lineTo(r,this.topPadding+i)):(e.moveTo(r,o),e.lineTo(r,o-s)),e.stroke(),e.save(),e.translate(r-this.xLength/2,o+s),this.xRorate?e.rotate(-this.xRorate*Math.PI/180):e.rotate(-this.xRotate*Math.PI/180),e.fillText(n,0,0),e.restore()}}},{key:"drawYAxis",value:function(){var e=this.ctx;e.beginPath(),e.strokeStyle=this.axisColor,e.moveTo(this.leftPadding-.5,this.canvas.height-this.bottomPadding+.5),e.lineTo(this.leftPadding-.5,this.topPadding+.5),e.stroke(),this.drawYPoint()}},{key:"drawYPoint",value:function(){var e=this.ctx;e.font=12*a+"px Microsoft YaHei",e.textAlign="right",e.textBaseline="middle",e.beginPath();for(var t=0;t<this.yEqual;t++){var n=this.leftPadding,r=this.canvas.height-this.bottomPadding-this.yLength*(t+1)+.5;this.showGrid?(e.strokeStyle=this.gridColor,e.moveTo(n,r),e.lineTo(this.canvas.width-this.rightPadding-i,r)):(e.strokeStyle=this.axisColor,e.moveTo(n-s,r),e.lineTo(n,r)),e.stroke(),e.save(),e.fillStyle=this.axisColor,e.translate(n-i,r),this.yRorate?e.rotate(-this.yRorate*Math.PI/180):e.rotate(-this.yRotate*Math.PI/180),e.fillText(this.ySpace*(t+1),0,0),e.restore()}}},{key:"drawLegend",value:function(){var e=this.legend;if(e.display){var t=this.ctx,a="pie"===this.type||"ring"===this.type;t.beginPath(),t.font=e.font,t.textAlign="left",t.textBaseline="middle";for(var n=a?this.labels.length:this.datasets.length,r=(this.canvas.width-(this.legend.textWidth+(5*n-2)*i))/2,o=0,l=0;l<n;l++){var c=a?this.datasets[0]:this.datasets[l],d=(a?this.labels[l]:c.label)||"";t.fillStyle=c.colorList&&c.colorList[l]||c.fillColor||this.colorList[l],"top"===e.position?(this.drawLegendIcon(r+5*i*l+o,e.top-s,2*i,i),t.fillStyle=e.color,t.fillText(d,r+(5*l+3)*i+o,e.top)):"bottom"===e.position?(this.drawLegendIcon(r+5*i*l+o,this.canvas.height-e.bottom-s,2*i,i),t.fillStyle=e.color,t.fillText(d,r+(5*l+3)*i+o,this.canvas.height-e.bottom)):(t.fillRect(i,e.top+2*i*l,2*i,i),t.fillStyle=e.color,t.fillText(d,4*i,e.top+2*i*l+.5*i)),o+=Math.ceil(t.measureText(d).width)}}}},{key:"drawLegendIcon",value:function(e,t,n,r){var o=this.ctx;"line"===this.type?(o.beginPath(),o.strokeStyle=o.fillStyle,o.lineWidth=2*a,o.moveTo(e,t+s),o.lineTo(e+2*i,t+s),o.stroke(),o.lineWidth=1*a,o.arc(e+i,t+s,3*a,0,2*Math.PI,!0),o.fill()):o.fillRect(e,t,n,r)}}]),n}()}))},"7ed4":function(e,t,a){"use strict";var i=a("2b0e"),s=new i["default"];t["a"]=s},"85f2":function(e,t,a){e.exports=a("454f")},8914:function(e,t,a){"use strict";(function(e){var i=a("aa47"),s=function(e,t,a,i,s,n,r,o,l,c){"boolean"!=typeof r&&(l=o,o=r,r=!1);var d,h="function"==typeof a?a.options:a;if(e&&e.render&&(h.render=e.render,h.staticRenderFns=e.staticRenderFns,h._compiled=!0,s&&(h.functional=!0)),i&&(h._scopeId=i),n?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},h._ssrRegister=d):t&&(d=r?function(){t.call(this,c(this.$root.$options.shadowRoot))}:function(e){t.call(this,o(e))}),d)if(h.functional){var u=h.render;h.render=function(e,t){return d.call(t),u(e,t)}}else{var f=h.beforeCreate;h.beforeCreate=f?[].concat(f,d):[d]}return a}({render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{ref:"wrapper"},[t("div",{key:this.tableKey},[this._t("default")],2)])},staticRenderFns:[]},void 0,{name:"ElementUiElTableDraggable",props:{handle:{type:String,default:""},animate:{type:Number,default:100}},data:function(){return{tableKey:0}},methods:{makeTableSortAble:function(){var e=this,t=this.$children[0].$el.querySelector(".el-table__body-wrapper tbody");i["default"].create(t,{handle:this.handle,animation:this.animate,onStart:function(){e.$emit("drag")},onEnd:function(t){var a=t.newIndex,i=t.oldIndex;e.keepWrapperHeight(!0),e.tableKey=Math.random();var s=e.$children[0].data,n=s.splice(i,1)[0];s.splice(a,0,n),e.$emit("drop",{targetObject:n,list:s})}})},keepWrapperHeight:function(e){var t=this.$refs.wrapper;t.style.minHeight=e?t.clientHeight+"px":"auto"}},mounted:function(){this.makeTableSortAble()},watch:{tableKey:function(){var e=this;this.$nextTick((function(){e.makeTableSortAble(),e.keepWrapperHeight(!1)}))}}},void 0,!1,void 0,void 0,void 0);function n(e){n.installed||(n.installed=!0,e.component("ElementUiElTableDraggable",s))}var r={install:n},o=null;"undefined"!=typeof window?o=window.Vue:"undefined"!=typeof e&&(o=e.Vue),o&&o.use(r),s.install=n,t["a"]=s}).call(this,a("c8ba"))},abbf:function(e,t,a){},b104:function(e,t,a){e.exports=a.p+"img/loading.png"},cfc2:function(e,t,a){e.exports=a.p+"img/img_new.jpg"},e025:function(e,t,a){"use strict";a("abbf")},e2ad:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:8}},[i("el-card",{staticClass:"mgb5",staticStyle:{height:"252px"},attrs:{shadow:"hover"}},[i("div",{staticClass:"user-info"},[i("img",{staticClass:"user-avator",attrs:{src:a("cfc2"),alt:""}}),i("div",{staticClass:"user-info-cont"},[i("div",{staticClass:"user-info-name"},[e._v(e._s(e.name))]),i("div",[e._v(e._s(e.role))])])]),i("div",{staticClass:"user-info-list"},[e._v("\n                    上次登录时间：\n                    "),i("span",[e._v("2020-11-01")])]),i("div",{staticClass:"user-info-list"},[e._v("\n                    上次登录地点：\n                    "),i("span",[e._v("广州")])])]),e._l(e.serverStats,(function(t,a){return i("el-card",{staticClass:"mgb5",attrs:{shadow:"hover"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v(e._s(t.title)+" Swoole服务详情")])]),t.flag?i("div",[i("el-form",{attrs:{"label-position":"right","label-width":"90px"}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"启动时间"}},[i("span",[e._v(e._s(t.startTime))])]),i("el-form-item",{attrs:{label:"php版本"}},[i("span",[e._v(e._s(t.phpVersion))])]),i("el-form-item",{attrs:{label:"swoole版本"}},[i("span",[e._v(e._s(t.swooleVersion))])]),i("el-form-item",{attrs:{label:"easy版本"}},[i("span",{staticClass:"success",attrs:{type:"success"}},[e._v(e._s(t.easyVersion))])])],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"工作进程"}},[i("span",[e._v(e._s(t.workerNum))])]),i("el-form-item",{attrs:{label:"空闲进程"}},[i("span",[e._v(e._s(t.idleWorkerNum))])]),i("el-form-item",{attrs:{label:"协程数量"}},[i("span",[e._v(e._s(t.coroutineNum))])]),i("el-form-item",{attrs:{label:"连接请求"}},[i("span",[e._v(e._s(t.connectNum)+" - "+e._s(t.requestNum))])])],1)],1)],1):i("div",[i("i",{staticClass:"el-icon-warning-outline warning-tag"},[e._v(" "+e._s(t.title)+" SWOOLE 服务不可用")])])])}))],2),i("el-col",{attrs:{span:16}},[e._e(),i("el-card",{staticStyle:{height:"403px"},attrs:{shadow:"hover"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("img",{staticClass:"warning-img",attrs:{src:a("b104"),alt:""}}),i("span",{staticClass:"waiting-do"},[e._v("待办事项")]),i("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[e._v("添加")])],1),i("el-table",{staticStyle:{width:"100%"},attrs:{"show-header":!1,data:e.todoList}},[i("el-table-column",{attrs:{width:"40"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-checkbox",{model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),i("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.desc?i("div",[i("el-popover",{attrs:{trigger:"hover",placement:"top"}},[i("p",[e._v(e._s(t.row.desc))]),i("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[i("div",{staticClass:"todo-item",class:{"todo-item-del":t.row.status}},[e._v(e._s(t.row.title))])])])],1):i("div",{staticClass:"todo-item",class:{"todo-item-del":t.row.status}},[e._v(e._s(t.row.title))])]}}])}),i("el-table-column",{attrs:{width:"60"}},[[i("i",{staticClass:"el-icon-edit"}),i("i",{staticClass:"el-icon-delete"})]],2)],1)],1)],1)],1),e._e()],1)},s=[],n=(a("6d67"),a("ac6aa"),a("f3e2"),a("7f7f"),a("f5ac")),r=(a("7ed4"),a("96cf"),a("3b8d")),o=a("d55d"),l=a("01ea");function c(e){return d.apply(this,arguments)}function d(){return d=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["a"])({url:l["a"].SWOOLE_DIPATCH_URI,method:"get",params:{uri:"/test/deploy/stats"}}));case 1:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function h(e){return u.apply(this,arguments)}function u(){return u=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["a"])({url:l["a"].SWOOLE_DIPATCH_URI,method:"get",baseURL:l["a"].GOLD_API_HOST,params:{uri:"/test/deploy/stats"}}));case 1:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function f(e){return p.apply(this,arguments)}function p(){return p=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["a"])({url:l["a"].SWOOLE_DIPATCH_URI,method:"get",baseURL:l["a"].AI_API_HOST,params:{uri:"/test/deploy/stats"}}));case 1:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}var m=a("ed08"),v={name:"dashboard",data:function(){return{name:localStorage.getItem("ms_username"),serverList:["Zera","Gold","Ai"],serverStats:[],todoList:[{title:"金本位的杠杆算法要优化一下。0.4X应该是不会爆仓才对？",status:!1,desc:"金本位的杠杆算法要优化一下。0.4X应该是不会爆仓才对"},{title:"研究一下全仓杠杆的计算公式在双借时候的场景 2种币都不够的时候反而杠杆计算变低了",status:!1,desc:"研究一下全仓杠杆的计算公式在双借时候的场景 在双借，且2种币都不够的时候反而杠杆计算变低了 我的想法是逐仓我们这样用是对的。因为2边肯定是对立关系。然后全仓的话我们要想想改一下 因为可能我借了U和BTC。都不跌。然后我持仓的其他小币狂跌"},{title:"BINANCE 仓位头寸更新延时 （缓存时间过久）",status:!1},{title:"仓位头寸出现新旧数据交替展示 （缓存时差问题）",status:!1},{title:"今天要写100行代码加几个bug吧",status:!0}],data:[{name:"2018/09/04",value:1083},{name:"2018/09/05",value:941},{name:"2018/09/06",value:1139},{name:"2018/09/07",value:816},{name:"2018/09/08",value:327},{name:"2018/09/09",value:228},{name:"2018/09/10",value:1065}],options:{type:"bar",title:{text:"最近一周各品类销售图"},xRorate:25,labels:["周一","周二","周三","周四","周五"],datasets:[{label:"家电",data:[234,278,270,190,230]},{label:"百货",data:[164,178,190,135,160]},{label:"食品",data:[144,198,150,235,120]}]},options2:{type:"line",title:{text:"最近几个月各品类销售趋势图"},labels:["6月","7月","8月","9月","10月"],datasets:[{label:"家电",data:[234,278,270,190,230]},{label:"百货",data:[164,178,150,135,160]},{label:"食品",data:[74,118,200,235,90]}]}}},components:{Schart:n["a"]},computed:{role:function(){return"admin"===this.name?"超级管理员":"普通用户"}},mounted:function(){this.loadServerStats(),setInterval(this.loadServerStats,6e4)},methods:{changeDate:function(){var e=(new Date).getTime();this.data.forEach((function(t,a){var i=new Date(e-864e5*(6-a));t.name="".concat(i.getFullYear(),"/").concat(i.getMonth()+1,"/").concat(i.getDate())}))},loadServerStats:function(){var e=this;this.serverList.map((function(t,a){var i,s={startTime:"",workerNum:0,idleWorkerNum:0,coroutineNum:0,connectNum:0,requestNum:0,phpVersion:"",swooleVersion:"",easyVersion:"111",title:t,flag:!0};switch(t){case"Gold":i=h({});break;case"Ai":i=f({});break;case"Zera":default:i=c({});break}i.then((function(t){if(console.log(t),!t.payload.data||t.payload.data.length<=0)return e.serverStats[a].flag=!1,!1;var i=t.payload.data;s.flag=!0,s.startTime=m["a"].fTime(i.server_stats.start_time),s.workerNum=i.server_stats.worker_num,s.idleWorkerNum=i.server_stats.idle_worker_num,s.coroutineNum=i.server_stats.coroutine_num,s.connectNum=i.server_stats.connection_num,s.requestNum=i.server_stats.request_count,s.phpVersion=i.easy_stats.php_version,s.swooleVersion=i.easy_stats.swoole_version,s.easyVersion=i.easy_stats.easy_swoole_version,e.$set(e.serverStats,a,s)})).catch((function(t){s.flag=!1,e.$set(e.serverStats,a,s)}))}))}}},g=v,b=(a("e025"),a("2877")),y=Object(b["a"])(g,i,s,!1,null,"6d606526",null);t["default"]=y.exports},f5ac:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("canvas",{attrs:{id:e.canvasId}})])},s=[],n=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("ac6aa"),a("456d"),a("85f2")),r=a.n(n);function o(e,t,a){return t in e?r()(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=a("2c8a"),c=a.n(l);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={props:{canvasId:{type:String,default:"",required:!0},options:{type:Object,required:!0}},mounted:function(){this.renderChart()},methods:{renderChart:function(){if(this.checkOptions()){var e=h({},this.options);new c.a(this.canvasId,e)}},checkOptions:function(){var e=this.options;return!(!e.datasets||!e.datasets.length)&&!(!e.labels||!e.labels.length)}},watch:{options:{handler:function(e,t){this.renderChart()},deep:!0}}},f=u,p=a("2877"),m=Object(p["a"])(f,i,s,!1,null,null,null);t["a"]=m.exports},fb4e:function(e,t,a){}}]);
//# sourceMappingURL=dashboard.js.map